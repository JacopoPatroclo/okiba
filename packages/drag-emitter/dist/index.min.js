var OkibaDragEmitter=function(){"use strict";function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,n){return(r=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function u(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function h(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],o=!0,i=!1,s=void 0;try{for(var r,u=t[Symbol.iterator]();!(o=(r=u.next()).done)&&(e.push(r.value),!n||e.length!==n);o=!0);}catch(t){i=!0,s=t}finally{try{o||null==u.return||u.return()}finally{if(i)throw s}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var c=function(){function t(){o(this,t),this.hs={}}return n(t,[{key:"on",value:function(t,n){(this.hs[t]||(this.hs[t]=[])).push(n)}},{key:"off",value:function(t,n){if(this.hs[t]){var e=this.hs[t].indexOf(n);e<0||this.hs[t].splice(e,1)}}},{key:"emit",value:function(t,n){if(this.hs&&this.hs[t])for(var e=0;e<this.hs[t].length;++e)this.hs[t][e](n)}},{key:"destroy",value:function(){var o=this;Object.entries(this.hs).forEach(function(t){var n=h(t,2),e=n[0];return n[1].forEach(function(t){return o.off(e,t)})}),delete this.hs}}]),t}();function a(t){return void 0===t?t:t instanceof Array?t:t.callee||t instanceof NodeList||t instanceof DOMTokenList?Array.prototype.slice.call(t):[t]}function l(t,n,e,o,i){if(!n||!e)return!1;for(var s=a(t),r=a(n),u=a(e),h=0;h<s.length;++h)for(var c=0;c<r.length;++c)s[h]["".concat(o,"EventListener")](r[c],u[Math.min(c,u.length-1)],i);return!0}function f(t,n,e,o){return l(t,n,e,"add",o)}function v(t,n,e,o){return l(t,n,e,"remove",o)}return function(t){function e(t){var n;return o(this,e),(n=u(this,s(e).call(this))).el=t,n.autoBind(),n.listen(),n}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&r(t,n)}(e,c),n(e,[{key:"destroy",value:function(){this.unlisten(),this.el=null}},{key:"setPointerDown",value:function(t){var n=t.clientX,e=t.clientY;this.pointerX=n,this.pointerY=e,this.isPointerDown=!0,this.el.classList.add("is-pointer-down")}},{key:"setPointerUp",value:function(){this.isPointerDown&&(this.isPointerDown=!1,this.pointerX=this.pointerY=null,this.el.classList.remove("is-pointer-down"),this.emit("dragend"))}},{key:"setPointerPos",value:function(t,n){this.isPointerDown&&this.emitDrag(t,n),this.pointerX=t,this.pointerY=n}},{key:"emitDrag",value:function(t,n){this.emit("drag",{deltaX:this.pointerX-t,clientX:t,deltaY:this.pointerY-n,clientY:n})}},{key:"onTouchStart",value:function(t){this.setPointerDown(t.touches[0])}},{key:"onTouchMove",value:function(t){this.setPointerPos(t.touches[0].clientX,t.touches[0].clientY)}},{key:"onTouchEnd",value:function(){this.setPointerUp()}},{key:"onMouseDown",value:function(t){this.setPointerDown(t)}},{key:"onMouseMove",value:function(t){this.setPointerPos(t.clientX,t.clientY)}},{key:"onMouseUp",value:function(){this.setPointerUp()}},{key:"listen",value:function(){f(this.el,"touchstart",this.onTouchStart),f(window,"touchmove",this.onTouchMove),f(window,"touchend",this.onTouchEnd),f(this.el,"mousedown",this.onMouseDown),f(window,"mousemove",this.onMouseMove),f(window,"mouseup",this.onMouseUp)}},{key:"unlisten",value:function(){v(this.el,"touchstart",this.onTouchStart),v(window,"touchmove",this.onTouchMove),v(window,"touchend",this.onTouchEnd),v(this.el,"mousedown",this.onMouseDown),v(window,"mousemove",this.onMouseMove),v(window,"mouseup",this.onMouseUp)}},{key:"autoBind",value:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this)}}]),e}()}();
