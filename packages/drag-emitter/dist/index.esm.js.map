{"version":3,"file":"index.esm.js","sources":["../index.js"],"sourcesContent":["/**\n * @module  DragEmitter\n * @description Emits drag events for all common pointers kinds (touch & mouse)\n */\nimport EventEmitter from '@okiba/event-emitter'\nimport {on, off} from '@okiba/dom'\n\n/**\n * @param {Element} el Element whose surface is used for drag events\n * @example\n * import {DragEmitter} from '@okiba/drag-emitter'\n * import {qs} from '@okiba/dom'\n *\n * const dragEmitter = new DragEmitter(qs('.container'))\n * dragEmitter.on(\n *   'drag',\n *   ({deltaX, clientX, deltaY, clientY}) => {\n *     console.log(deltaX, clientX, deltaY, clientY)\n *   }\n */\nclass DragEmitter extends EventEmitter {\n  constructor(el) {\n    super()\n    this.el = el\n    this.autoBind()\n    this.listen()\n  }\n\n  /**\n   * Unbinds events from the element and deletes the reference.\n   * To be called when the instance is not needed anymore for cleanup.\n   */\n  destroy() {\n    this.unlisten()\n    this.el = null\n  }\n\n  setPointerDown({clientX, clientY}) {\n    this.pointerX = clientX\n    this.pointerY = clientY\n\n    this.isPointerDown = true\n    this.el.classList.add('is-pointer-down')\n  }\n\n  setPointerUp() {\n    if (!this.isPointerDown) return\n\n    this.isPointerDown = false\n    this.pointerX = this.pointerY = null\n    this.el.classList.remove('is-pointer-down')\n    this.emit('dragend')\n  }\n\n  setPointerPos(xCoord, yCoord) {\n    if (this.isPointerDown) {\n      this.emitDrag(xCoord, yCoord)\n    }\n\n    this.pointerX = xCoord\n    this.pointerY = yCoord\n  }\n\n  emitDrag(xCoord, yCoord) {\n    this.emit('drag', {\n      deltaX: this.pointerX - xCoord,\n      clientX: xCoord,\n      deltaY: this.pointerY - yCoord,\n      clientY: yCoord\n    })\n  }\n\n  onTouchStart(e) {\n    this.setPointerDown(e.touches[0])\n  }\n\n  onTouchMove(e) {\n    this.setPointerPos(\n      e.touches[0].clientX,\n      e.touches[0].clientY,\n    )\n  }\n\n  onTouchEnd() {\n    this.setPointerUp()\n  }\n\n  onMouseDown(e) {\n    this.setPointerDown(e)\n  }\n\n  onMouseMove(e) {\n    this.setPointerPos(\n      e.clientX,\n      e.clientY\n    )\n  }\n\n  onMouseUp() {\n    this.setPointerUp()\n  }\n\n  listen() {\n    on(this.el, 'touchstart', this.onTouchStart)\n    on(window, 'touchmove', this.onTouchMove)\n    on(window, 'touchend', this.onTouchEnd)\n\n    on(this.el, 'mousedown', this.onMouseDown)\n    on(window, 'mousemove', this.onMouseMove)\n    on(window, 'mouseup', this.onMouseUp)\n  }\n\n  unlisten() {\n    off(this.el, 'touchstart', this.onTouchStart)\n    off(window, 'touchmove', this.onTouchMove)\n    off(window, 'touchend', this.onTouchEnd)\n\n    off(this.el, 'mousedown', this.onMouseDown)\n    off(window, 'mousemove', this.onMouseMove)\n    off(window, 'mouseup', this.onMouseUp)\n  }\n\n  autoBind() {\n    this.onTouchStart = this.onTouchStart.bind(this)\n    this.onTouchMove = this.onTouchMove.bind(this)\n    this.onTouchEnd = this.onTouchEnd.bind(this)\n\n    this.onMouseDown = this.onMouseDown.bind(this)\n    this.onMouseMove = this.onMouseMove.bind(this)\n    this.onMouseUp = this.onMouseUp.bind(this)\n  }\n}\n\nexport default DragEmitter\n"],"names":["DragEmitter","el","autoBind","listen","unlisten","clientX","clientY","pointerX","pointerY","isPointerDown","classList","add","remove","emit","xCoord","yCoord","emitDrag","deltaX","deltaY","e","setPointerDown","touches","setPointerPos","setPointerUp","on","onTouchStart","window","onTouchMove","onTouchEnd","onMouseDown","onMouseMove","onMouseUp","off","bind","EventEmitter"],"mappings":"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"}